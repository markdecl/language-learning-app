
<%= render "components/user_deck_card", user_deck: @user_deck, deck: @decks %>

<%# <h2>Ordered by user_deck_flashcard.due_to_learn:</h2> %>

<div class= "d-flex m-4 justify-content-evenly">
  <%# <div class="d-grid gap-2"> %>
  <%= link_to "Ignore individual cards", user_decks_path, class: "btn btn-primary shadow", method: :patch %>
  <%= link_to "Ignore first x cards", user_decks_path, class: "btn btn-primary shadow", method: :patch %>
  <%# </div> %>
</div>

<table class="table table-sm table-hover table-responsive shadow">
  <thead>
    <tr class="table-dark">
      <th scope="col" class="d-none d-sm-table-cell">Frequency Rank</th>
      <th scope="col">Question</th>
      <th scope="col">Answer</th>
      <th scope="col" class="d-none d-sm-table-cell">Next Review</th>
    </tr>
  </thead>
  <tbody>
      <% @user_deck_flashcards.each do | user_deck_flashcard | %>
    <%# <% @flashcards_ordered.each do | flashcard | %>
      <%# <%= flashcard.attributes %>

      <% flashcard = @flashcards.find(user_deck_flashcard.flashcard_id) %>
      <%# <% user_deck_flashcard = @user_deck_flashcards.find_by(flashcard_id: flashcard.id) %>

      <% if user_deck_flashcard.learnt %>
        <% if user_deck_flashcard.next_review.past? %>
          <tr class="table-warning">
        <% else %>
          <tr class="table-success">
        <% end %>
      <% else %>
        <% if user_deck_flashcard.due_to_learn.past? %>
          <tr class="table-danger">
        <% else %>
          <tr class="table-light">
        <% end %>
      <% end %>

        <td scope="row" class="d-none d-sm-table-cell"><%= flashcard.frequency_rank %></td>
        <td><%= flashcard.question %></td>
        <td><%= flashcard.answer %></td>
        <td class="d-none d-sm-table-cell">
          <% unless user_deck_flashcard.next_review.nil? %>
            <%#= user_deck_flashcard.next_review %>
            <% time_difference = user_deck_flashcard.next_review - Time.now %>
            <%# <%= DateTime.Today.AddDays(1) %>
            <%# <%= time_difference %>
            <br>
            <% if user_deck_flashcard.next_review.past? %>
              Due
            <% elsif time_difference < (24 * 60 * 60) %>
              <% if time_difference < (60 * 60) %>
                Less than an hour
              <% else %>
                in <%= (time_difference / (60 * 60)).round %> hour(s)
              <% end %>
            <% elsif user_deck_flashcard.next_review.to_date == Date.tomorrow %>
              Tomorrow
            <% else %>
              <%= user_deck_flashcard.next_review %>
            <% end %>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
